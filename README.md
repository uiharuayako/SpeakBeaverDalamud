# SpeakBeaver 语音大河狸

这是一个让FF14支持语音输入的程序。和[Python版](https://github.com/uiharuayako/SpeakBeaver)原理相同但更为方便快捷  

其主要有两个，相互独立的功能
1. 语音转文字：使用讯飞的api进行语音转文字，并且把转换结果输出到聊天框，这部分功能需要联网  
2. 语音控制：加载插件后，使用``/svoice``进行配置，使用.net的API，实现识别特定语音命令，并在游戏内执行对应命令，比如你设置关键词为``天辉``，命令为``/ac 天辉``，就可以打一发技能出去。**注意！这个东西的灵敏度非常高，设置两个字的命令很可能会导致频繁发生错误识别，建议设长一点的词，或者少设几个。**  
而且这个语音控制是可能和语音转文字同时进行的，就比如默认设置里有一个“停止语音转写”的命令，但是说出这句话时，语音转文字会被优先触发，就会在你设置的频道输出这句话。所以建议在设置里配置“输入停止词”以达到结束语音输入的效果。  
## 在语音里和亲友聊天时频繁误识别命令怎么办？
当你进行其他语音活动时，比如在kook和亲友高强度聊天，请在语音控制界面把语音控制功能关掉，不然会频繁误识别。除了在界面开关语音控制功能，也可以使用``/svoice stop``来关闭，``/svoice start``来开启。  
插拔麦克风后重启语音控制可能需要重新初始化语音服务，也就是说“当前语音服务状态”不是静默或者停止时，想开启语音服务的话，就要点一下初始化语音服务按钮。如果语音控制功能出了其他问题也可以点一下这个按钮试试，如果还不行就重启一下插件。

## 语音转文字配置方式
1. 在Dalamud设置-测试版中添加我的插件库``https://raw.githubusercontent.com/uiharuayako/DalamudPlugins/main/pluginmaster.json``，加载插件``Speak Beaver``
2. 进入[讯飞开放平台](https://www.xfyun.cn/)，申请一个开发者账号
3. 进入控制台，点击创建新应用，随便写一点内容。再次进入控制台，进入你创建的应用，在左边的菜单里找到 **语音听写（流式版）** 。这个东西每天都有500次的免费识别次数，真的真的用不完，相信我。如果你实在担心用完或者想和很多亲友分享（5人以上？），设置个支付密码就可以白嫖50000的服务量。
4. 在右边找到“服务接口认证信息”，把APPID、APISecret、APIKey的一串代码复制到插件设置的讯飞Api设置里，注意不要多复制出空格。
5. 服务接口认证信息下面有一个高级功能，把“多候选-句级”开通（暂时还没做这个功能，但是接口里填了这个参数，理论上开不开通功能是一样的）
6. （非必要）在QolBar里添加并修改这个快捷方式，把按键改成你觉得方便点的  
``
H4sIAAAAAAAACqtWUimpLEhVslJKVdJRSjJSsqqGiwB5Okp5QEZwQWpitlNqYllqEVCk2EfJKhqhqhimyiM/F2RGMpCpXwzSAeRk+gPVGugZ6ABxLJAbpGQF4iklBxcAJSx0TGJrdbAY9XRD/8sZ81EMU0jOSMxLT1WAS5Fr9J6Gp8u7UY0uLkksKqHAyMY5z9YuQjcyv4B8E1+s2/d87zo0/+fnpWWmk2/ms77lTzu2wc0sy89MBkUXEaYBhZPCgcI6SiAhhNpihH1KZUBDjfSM9Yz0DJRqAT9/qf1VAgAA
``
7. （非必要）打开插件主界面（命令``/speak``），查看命令列表，把命令列表中的命令写到宏里绑定到你觉得方便的快捷键上。
8.  在设置中把输入设备切到你正在使用的麦克风，然后使用命令或者点击插件主界面的 开始语音输入 按钮，或者对着你的麦克风大喊``“开始语音转写”``，测试一下语言输入能不能正常工作

## 进阶设置？
在讯飞开放平台-控制台-语音听写流式版中，有一个个性化热词功能，可以添加FF14中的专有名词来让识别更准确，在这里举个栗子：  
```
主坦
副坦
纯奶
盾奶
近战
法系
远敏
```
如果你有了更完整的列表，比如把FF的一些职业，地名，技能名称，BOSS名列出来了，请提个issue！  
遗憾的是他不支持英文，像D1 D2这种词还是会识别成第一，第二。在上线的正式版中，将会加入词语替换功能。~~（现在先摆一会）~~已经加上这个功能了

### ？
以下有一段隐藏的文字，他是什么呢？
<!-- 我怀疑没人看这个Readme。如果你看到这句话还恰好在猪区，可以发邮件到uiharuayako@gmail.com，附上你的id区服，我会和你商量一个时间，送你100w金币 -->